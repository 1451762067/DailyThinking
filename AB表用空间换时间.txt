AB表以空间换时间的原理 建信金科

上周因为P4的问题，导致一度想要改same库，对于改的方案，有同事提出AB表的方案，
说可以解决锁的问题，用空间换时间，下面我对分析下该方案的原理。

约定：没有AB表的方案，下称为A方案，AB表的方案，称为B方案。

在A方案中，只有一块共享内存，任何往共享内存的写动作都要加锁，具完全的排他性，
如果写的时间比较长，那么其他人都得等待。

在B方案中，如何在AB表之间切换肯定也需要个标识，该标识有读端，有写端，
所以还是得需要锁这个东西来同步，并非如有些人所言，有了AB表就可以把锁拿掉，
既然AB表也有锁，那他的优势体现在哪里呢，在AB表中，在加锁的期间，写端唯一要做的事儿就是改那个标识，
这个动作可比写整块共享内存快多了，所以虽然他也加锁，但是持有锁的时间非常短，以至于几乎不会有人因此等待。

对比可知，在A方案中，锁期间要写整块内存，慢，在B方案中，锁期间仅需改变某变量的值，
快，B方案中相当于把写共享内存的动作移除加锁的期间，但是B方案需要double倍的内存，所以说用空间换了时间。
